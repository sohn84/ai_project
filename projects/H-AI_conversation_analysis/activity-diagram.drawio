<mxfile host="app.diagrams.net" modified="2025-01-20T00:00:00.000Z" agent="5.0" version="21.0.0" etag="activity-diagram" type="device">
  <diagram name="H-AI 대화분석 플로우" id="flow-diagram">
    <mxGraphModel dx="1422" dy="794" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1169" pageHeight="1654" math="0" shadow="0">
      <root>
        <mxCell id="0"/>
        <mxCell id="1" parent="0"/>
        <mxCell id="start" value="시작" style="ellipse;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366" vertex="1" parent="1">
          <mxGeometry x="520" y="40" width="120" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="inputBranch" value="입력 방식 선택" style="rhombus;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656" vertex="1" parent="1">
          <mxGeometry x="500" y="140" width="160" height="100" as="geometry"/>
        </mxCell>
        <mxCell id="webUI" value="웹 UI (Flask)&#xa;http://localhost:4000" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf" vertex="1" parent="1">
          <mxGeometry x="280" y="280" width="180" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="fileUpload" value="CSV/Excel 파일 업로드&#xa;(최대 200MB)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf" vertex="1" parent="1">
          <mxGeometry x="280" y="380" width="180" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="cli" value="CLI 실행&#xa;python run_analysis.py [파일경로]" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf" vertex="1" parent="1">
          <mxGeometry x="700" y="280" width="180" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="filePath" value="CSV 파일 경로 지정&#xa;(기본: 20260205_26033건.csv)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf" vertex="1" parent="1">
          <mxGeometry x="700" y="380" width="180" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="loadData" value="데이터 로드 및 정규화&#xa;load_chat_log_any()&#xa;• CSV/Excel 파싱&#xa;• 컬럼 정규화 (날짜, 답변순서)&#xa;• 문자열 정제" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450" vertex="1" parent="1">
          <mxGeometry x="480" y="500" width="200" height="100" as="geometry"/>
        </mxCell>
        <mxCell id="analysis1" value="1. 질문 유형·키워드 분석&#xa;analyze_question_types()&#xa;• 카테고리별 건수/비중&#xa;• 분류별 건수/비중&#xa;• 키워드별 출현 빈도" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6" vertex="1" parent="1">
          <mxGeometry x="480" y="650" width="200" height="80" as="geometry"/>
        </mxCell>
        <mxCell id="analysis2" value="2. 불만/부정 키워드·원인 분석&#xa;analyze_negative()&#xa;• 부정 키워드 빈도&#xa;• 오답 원인 분류&#xa;  (AI 답변 불만 vs 화풀이 vs 불명확)&#xa;• 카테고리별 오답 분포" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6" vertex="1" parent="1">
          <mxGeometry x="480" y="770" width="200" height="100" as="geometry"/>
        </mxCell>
        <mxCell id="analysis3" value="3. 문맥·의도 분석&#xa;run_context_and_intent_analysis()&#xa;• 세션 문맥 분석&#xa;  (오답 직후 불만, 첫턴 부정)&#xa;• 의도 클러스터링&#xa;  (TF-IDF + KMeans)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6" vertex="1" parent="1">
          <mxGeometry x="480" y="910" width="200" height="100" as="geometry"/>
        </mxCell>
        <mxCell id="analysis4" value="4. Conversation Review&#xa;+ 고객 심리 분석&#xa;run_conversation_review_analysis()&#xa;• 세션 리뷰 지표&#xa;  (오답 1회/2회 이상 세션)&#xa;• 고객 심리 지표&#xa;  (긴급/불안, 혼란/모호)&#xa;• 숨은 리스크 요약" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6" vertex="1" parent="1">
          <mxGeometry x="480" y="1050" width="200" height="120" as="geometry"/>
        </mxCell>
        <mxCell id="analysis5" value="5. 개선 권고 생성&#xa;build_recommendations()&#xa;• RAG 강화 권고&#xa;• 프롬프트 튜닝 권고&#xa;• 피드백 루프 권고&#xa;• 우선순위 요약" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6" vertex="1" parent="1">
          <mxGeometry x="480" y="1210" width="200" height="100" as="geometry"/>
        </mxCell>
        <mxCell id="mergeResults" value="분석 결과 통합&#xa;report = {&#xa;  질문_유형_분석,&#xa;  불만_부정_분석,&#xa;  문맥_의도_분석,&#xa;  대화_리뷰_분석,&#xa;  개선_권고&#xa;}" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656" vertex="1" parent="1">
          <mxGeometry x="480" y="1350" width="200" height="100" as="geometry"/>
        </mxCell>
        <mxCell id="checkExisting" value="기존 JSON 확인&#xa;(개선_권고_상세 유지)" style="rhombus;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656" vertex="1" parent="1">
          <mxGeometry x="480" y="1490" width="200" height="80" as="geometry"/>
        </mxCell>
        <mxCell id="saveJSON" value="JSON 저장&#xa;analysis_report.json" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366" vertex="1" parent="1">
          <mxGeometry x="280" y="1620" width="140" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="saveHTML" value="HTML 보고서 생성&#xa;analysis_report.html&#xa;(비개발자용)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366" vertex="1" parent="1">
          <mxGeometry x="480" y="1620" width="140" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="saveTXT" value="요약 텍스트 저장&#xa;analysis_summary.txt" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366" vertex="1" parent="1">
          <mxGeometry x="680" y="1620" width="140" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="webDisplay" value="웹 UI에 HTML 표시&#xa;(iframe)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf" vertex="1" parent="1">
          <mxGeometry x="280" y="1720" width="140" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="llmBranch" value="LLM 개선 권고&#xa;상세화 필요?" style="rhombus;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656" vertex="1" parent="1">
          <mxGeometry x="480" y="1720" width="200" height="80" as="geometry"/>
        </mxCell>
        <mxCell id="llmRequest" value="LLM 요청&#xa;(채팅에서)&#xa;• analysis_report.json 전달&#xa;• 개선_권고_상세 생성 요청" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00" vertex="1" parent="1">
          <mxGeometry x="720" y="1720" width="160" height="80" as="geometry"/>
        </mxCell>
        <mxCell id="updateJSON" value="JSON 수동 업데이트&#xa;개선_권고_상세 추가" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00" vertex="1" parent="1">
          <mxGeometry x="720" y="1840" width="160" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="regenerateHTML" value="HTML 재생성&#xa;python -m src.report_html" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00" vertex="1" parent="1">
          <mxGeometry x="720" y="1940" width="160" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="end" value="종료" style="ellipse;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450" vertex="1" parent="1">
          <mxGeometry x="520" y="2040" width="120" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="arrow1" value="" style="endArrow=classic;html=1;rounded=0;strokeWidth=2" edge="1" parent="1" source="start" target="inputBranch">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="arrow2" value="웹 UI" style="endArrow=classic;html=1;rounded=0;strokeWidth=2;labelBackgroundColor=#ffffff" edge="1" parent="1" source="inputBranch" target="webUI">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="arrow3" value="" style="endArrow=classic;html=1;rounded=0;strokeWidth=2" edge="1" parent="1" source="webUI" target="fileUpload">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="arrow4" value="CLI" style="endArrow=classic;html=1;rounded=0;strokeWidth=2;labelBackgroundColor=#ffffff" edge="1" parent="1" source="inputBranch" target="cli">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="arrow5" value="" style="endArrow=classic;html=1;rounded=0;strokeWidth=2" edge="1" parent="1" source="cli" target="filePath">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="arrow6" value="" style="endArrow=classic;html=1;rounded=0;strokeWidth=2" edge="1" parent="1" source="fileUpload" target="loadData">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="arrow7" value="" style="endArrow=classic;html=1;rounded=0;strokeWidth=2" edge="1" parent="1" source="filePath" target="loadData">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="arrow8" value="" style="endArrow=classic;html=1;rounded=0;strokeWidth=2" edge="1" parent="1" source="loadData" target="analysis1">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="arrow9" value="" style="endArrow=classic;html=1;rounded=0;strokeWidth=2" edge="1" parent="1" source="analysis1" target="analysis2">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="arrow10" value="" style="endArrow=classic;html=1;rounded=0;strokeWidth=2" edge="1" parent="1" source="analysis2" target="analysis3">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="arrow11" value="" style="endArrow=classic;html=1;rounded=0;strokeWidth=2" edge="1" parent="1" source="analysis3" target="analysis4">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="arrow12" value="" style="endArrow=classic;html=1;rounded=0;strokeWidth=2" edge="1" parent="1" source="analysis4" target="analysis5">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="arrow13" value="" style="endArrow=classic;html=1;rounded=0;strokeWidth=2" edge="1" parent="1" source="analysis5" target="mergeResults">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="arrow14" value="" style="endArrow=classic;html=1;rounded=0;strokeWidth=2" edge="1" parent="1" source="mergeResults" target="checkExisting">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="arrow15" value="" style="endArrow=classic;html=1;rounded=0;strokeWidth=2" edge="1" parent="1" source="checkExisting" target="saveJSON">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="arrow16" value="" style="endArrow=classic;html=1;rounded=0;strokeWidth=2" edge="1" parent="1" source="checkExisting" target="saveHTML">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="arrow17" value="" style="endArrow=classic;html=1;rounded=0;strokeWidth=2" edge="1" parent="1" source="checkExisting" target="saveTXT">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="arrow18" value="웹 UI 경로" style="endArrow=classic;html=1;rounded=0;strokeWidth=2;labelBackgroundColor=#ffffff" edge="1" parent="1" source="saveHTML" target="webDisplay">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="arrow19" value="CLI 경로" style="endArrow=classic;html=1;rounded=0;strokeWidth=2;labelBackgroundColor=#ffffff" edge="1" parent="1" source="saveHTML" target="llmBranch">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="arrow20" value="예" style="endArrow=classic;html=1;rounded=0;strokeWidth=2;labelBackgroundColor=#ffffff" edge="1" parent="1" source="llmBranch" target="llmRequest">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="arrow21" value="아니오" style="endArrow=classic;html=1;rounded=0;strokeWidth=2;labelBackgroundColor=#ffffff" edge="1" parent="1" source="llmBranch" target="end">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="arrow22" value="" style="endArrow=classic;html=1;rounded=0;strokeWidth=2" edge="1" parent="1" source="llmRequest" target="updateJSON">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="arrow23" value="" style="endArrow=classic;html=1;rounded=0;strokeWidth=2" edge="1" parent="1" source="updateJSON" target="regenerateHTML">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="arrow24" value="" style="endArrow=classic;html=1;rounded=0;strokeWidth=2" edge="1" parent="1" source="regenerateHTML" target="end">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="arrow25" value="" style="endArrow=classic;html=1;rounded=0;strokeWidth=2" edge="1" parent="1" source="webDisplay" target="end">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
