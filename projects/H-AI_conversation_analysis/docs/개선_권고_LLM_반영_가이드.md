# 개선 권고 LLM 반영 가이드

Py 분석에서는 **규칙 기반 요약**만 생성합니다. **구체적인 RAG 강화 항목·프롬프트 수정안**은 아래 워크플로우로 LLM(채팅) 검토 후 JSON에 반영하는 것을 권장합니다.

## 1. 워크플로우

1. **분석 실행**  
   `python run_analysis.py` → `analysis_report.json`, `analysis_report.html` 생성.

2. **채팅에서 LLM 요청**  
   예시:  
   *「이 analysis_report.json 내용을 기반으로, 오답 원인·카테고리별 오답·오답사유 빈도 구문·샘플 5건을 참고해서,  
   어떤 RAG를 어떤 순서로 강화할지, 프롬프트는 어떻게 구체적으로 수정할지 LLM으로 종합 분석해 줘.  
   결과를 JSON의 '개선_권고_상세' 형식에 맞춰서 넣을 수 있게 만들어 줘.»*

3. **JSON 수동 반영**  
   LLM이 제안한 내용을 `analysis_report.json`의 `개선_권고` 안에 **`개선_권고_상세`** 키로 추가(또는 수정)합니다.

4. **HTML 재생성 (선택)**  
   JSON을 수정한 뒤 `python -m src.report_html analysis_report.json`으로 HTML을 다시 만들면, 보고서에 개선 권고 상세가 반영됩니다.

## 2. JSON 구조 제안 (`개선_권고_상세`)

```json
"개선_권고": {
  "개선_권고_LLM_검토_안내": "...",
  "rag_강화": [...],
  "프롬프트_튜닝": [...],
  "피드백_루프": [...],
  "우선순위_요약": [...],
  "개선_권고_상세": {
    "rag_강화_상세": [
      { "대상": "기타문의", "우선순위": 1, "구체_내용": "..." },
      ...
    ],
    "프롬프트_튜닝_상세": [
      { "항목": "직접 답변 우선", "구체_문구_예시": "...", "설명": "..." },
      ...
    ],
    "피드백_루프_상세": [
      { "항목": "...", "설명": "..." }
    ]
  }
}
```

- `개선_권고_상세`가 있으면 HTML 보고서 **「4. 개선 권고」** 섹션에서 **「개선 권고 상세 (LLM·담당자 검토 반영)」**으로 렌더링됩니다.
- 리스트 항목은 `항목`/`대상`, `설명`/`권고`/`구체_내용` 등으로 넣으면 HTML에서 자동으로 표시됩니다.

## 3. 의견 요약

- **Py에서 LLM 호출하지 않는 이유**: API 키·환경 의존성, 비용, 재현성 관리 부담을 줄이기 위함입니다.
- **JSON 생성 후 채팅에서 한 번만 요청**하면, 같은 분석 결과를 바탕으로 **뽀족한 개선안**을 받고, 그걸 JSON에만 반영하면 됩니다.
- 나중에 자동화가 필요하면, “분석 JSON 생성 → 별도 스크립트/서비스에서 LLM 호출 → `개선_권고_상세` 필드 채움 → JSON 저장” 순으로 확장할 수 있습니다.
